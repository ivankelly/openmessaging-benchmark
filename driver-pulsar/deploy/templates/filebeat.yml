filebeat.prospectors:
- type: log
  enabled: true
  paths:
    - /opt/pulsar/logs/pulsar-broker.log
  fields:
    service: broker
    nodename: {{ hostvars[inventory_hostname]["tags.Name"] }}
  multiline.pattern: ^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}
  multiline.negate: true
  multiline.match: after

- type: log
  enabled: true
  paths:
    - /opt/pulsar/logs/zookeeper.log
  fields:
    service: zookeeper
    nodename: {{ hostvars[inventory_hostname]["tags.Name"] }}
  multiline.pattern: ^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}
  multiline.negate: true
  multiline.match: after

- type: log
  enabled: true
  paths:
    - /opt/pulsar/logs/bookkeeper.log
  fields:
    service: bookkeeper
    nodename: {{ hostvars[inventory_hostname]["tags.Name"] }}
  multiline.pattern: ^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}
  multiline.negate: true
  multiline.match: after

filebeat.config.modules:
  path: ${path.config}/modules.d/*.yml
  reload.enabled: false

setup.template.settings:
  index.number_of_shards: 3

output.logstash:
  hosts: ["{{ logstashBeatsEndpoint }}"]
